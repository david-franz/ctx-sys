# F10h.6: MCP context_query Defaults

**Phase**: 10h - Infrastructure & Performance
**Priority**: Low
**Dependencies**: None

## Problem

The MCP `context_query` tool required agents to explicitly pass `expand: true` and `gate: true` every call for optimal results. Since most agents (Claude Code, etc.) call `context_query` speculatively, the lack of defaults meant:

- **Without expand**: Context contained only direct matches, missing parent classes, imports, and type definitions that fill out understanding
- **Without gate**: Trivial queries like "what is a string?" triggered full retrieval pipelines unnecessarily

## Fix

In `src/mcp/tool-registry.ts`, changed the `context_query` handler to default both to true:

```typescript
// Before:
expand,
gate,

// After:
expand: expand ?? true,
gate: gate ?? true,
```

Agents can still explicitly pass `false` to override when needed.

## Rationale

- **expand=true**: Agents benefit from richer context. The expansion system respects the token budget (default 2000 tokens for expansion), so it adds value without exceeding limits.
- **gate=true**: When an agent calls `context_query` with a trivial query, gating returns a minimal response quickly rather than running the full multi-strategy search pipeline. This saves latency and Ollama compute.

## Files Changed

- `src/mcp/tool-registry.ts` â€” default expand and gate to true, update tool description
