# F10d.2 Unify CLI/MCP Database Path

**Phase**: 10d - Bug Fixes & Cleanup
**Priority**: Critical
**Dependencies**: None

## Problem

The CLI and MCP server use different databases. The CLI uses `ConfigManager.resolve()` which resolves to the project-local `.ctx-sys/ctx-sys.db`. The MCP server's `serve.ts` passes `undefined` as dbPath, causing `AppContext` to default to the global `~/.ctx-sys/ctx-sys.db`.

This means indexing via CLI doesn't populate the MCP's data, and vice versa. A user who runs `ctx-sys index` then queries via Claude Desktop gets nothing because they're looking at different databases.

### Root Cause

- CLI: `ConfigManager.resolve(projectPath)` → `join(projectPath, '.ctx-sys', 'ctx-sys.db')`
- MCP: `AppContext(undefined)` → `getDefaultDbPath()` → `~/.ctx-sys/ctx-sys.db`

## Implementation

### File: `src/cli/serve.ts`

- Import `ConfigManager` and `existsSync`
- Add `--project` CLI option
- Before creating server: check if CWD (or --project) has `.ctx-sys/` directory
- If found, use `ConfigManager.resolve()` to get project-local db path
- If not found, fall back to global default (existing behavior)

## Success Criteria

- `ctx-sys serve` from a project directory uses the project-local database
- `ctx-sys serve --project /path/to/project` uses that project's database
- `ctx-sys serve` from a non-project directory falls back to global database
- Data indexed via CLI is visible to MCP tools and vice versa
