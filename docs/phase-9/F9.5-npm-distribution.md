# F9.5 NPM Package Distribution

**Phase**: 9 - Analytics, Support, & Web
**Priority**: Critical (First Step)
**Dependencies**: F1.5 MCP Server, F7.4 CLI Interface

## Goal

Provide a zero-friction installation method for developers to start using ctx-sys immediately via their existing Node.js toolchain. This serves as the top-of-funnel acquisition channel.

## Overview

Before users commit to downloading a desktop app, they often want to try the tool via CLI. Publishing `ctx-sys` as a globally installable npm package (`npm install -g ctx-sys`) enables this immediate "time-to-value". This package acts as the standalone CLI version of the product.

## Tech Stack

- **Registry**: npm + GitHub Packages
- **Build**: tsup (for bundling TypeScript)
- **Binaries**: pre-bundled sqlite-vec dependencies for major OSs

## Key Features

### 1. Unified CLI Entrypoint
- Command: `ctx` (shorthand for `ctx-sys`)
- Capabilities:
  - `ctx start`: Runs the MCP server (stdio mode).
  - `ctx index`: Manually indexes the current directory.
  - `ctx status`: Shows index stats and health.
  - `ctx login`: Authenticates with the cloud platform (F10.2).

### 2. Post-Install Setup
- **Ollama Detection**: automatically checks for `ollama` in PATH.
- **Config Init**: Interactive `ctx init` wizard to generate `.ctx-sys.json` config file.

### 3. MCP Quick-Connect
- Helper command `ctx connect <tool>`:
  - `ctx connect claude`: Automatically edits `claude_desktop_config.json` to add ctx-sys.
  - `ctx connect cursor`: Outputs instructions for Cursor MCP setup.

## Implementation Plan

1. **Package Structuring**:
   - Ensure `package.json` has `bin` entry pointing to `dist/cli/index.js`.
   - Add `.npmignore` to exclude source, tests, and docs.
2. **Bundling**:
   - Configure build script to bundle dependencies (except native modules) to ensure fast startup.
   - Handle native module resolution (sqlite, tree-sitter) for different platforms.
3. **CI/CD Pipeline**:
   - GitHub Action to publish to npm on semantic version tagging (`v*`).
   - Automated smoke tests on Windows, Mac, and Linux runners.
4. **Documentation**:
   - Update README with `npm install -g ctx-sys` badges and instructions.
